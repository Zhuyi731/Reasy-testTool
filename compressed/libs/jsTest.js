var fs=require("fs"),path=require("path"),rd=require("readline"),util=require("./../common/utils"),opt=require("./../common/checkConfig"),jslint=require("jslint"),errNum=0,errLogPath=opt.errorLogPath;function jsTest(e,r,t){var i=e[0],o=require("readline").createInterface({input:fs.createReadStream(i)}),n="";o.on("line",function(e){n=n+e+"\n"}),o.on("close",function(){var o=require("jslint").LintStream;l=new o(r);var s=i,a=n;l.write({file:s,body:a}),l.on("data",function(e,r,t){errNum+=e.linted.errors.length,fs.existsSync(errLogPath)||fs.mkdirSync(errLogPath),fs.writeFileSync(errLogPath+"/js-"+i.split("\\").pop().split(".")[0]+"-errLog.txt",util.dealErrLog(e.linted.errors),"utf8",e=>{if(e)throw e;console.log("写入log文件出现错误")})}),e.splice(0,1),0==e.length?t.call(this,errNum):jsTest(e,r,t)})}module.exports=jsTest;